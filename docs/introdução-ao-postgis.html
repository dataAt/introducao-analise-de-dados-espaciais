<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="python.html"/>
<link rel="next" href="para-saber-mais.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introdução.html"><a href="introdução.html"><i class="fa fa-check"></i><b>1</b> Introdução 🗺</a><ul>
<li class="chapter" data-level="1.1" data-path="introdução.html"><a href="introdução.html#representações-de-dados-espaciais"><i class="fa fa-check"></i><b>1.1</b> Representações de dados espaciais</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introdução.html"><a href="introdução.html#vetoriais"><i class="fa fa-check"></i><b>1.1.1</b> Vetoriais</a></li>
<li class="chapter" data-level="1.1.2" data-path="introdução.html"><a href="introdução.html#matriciais"><i class="fa fa-check"></i><b>1.1.2</b> Matriciais</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introdução.html"><a href="introdução.html#sistema-de-referência-espacial"><i class="fa fa-check"></i><b>1.2</b> Sistema de referência espacial</a></li>
<li class="chapter" data-level="1.3" data-path="introdução.html"><a href="introdução.html#projeções-cartográficas"><i class="fa fa-check"></i><b>1.3</b> Projeções cartográficas</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introdução.html"><a href="introdução.html#tipos-de-projeção"><i class="fa fa-check"></i><b>1.3.1</b> Tipos de projeção</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introdução.html"><a href="introdução.html#sistema-de-coordenadas"><i class="fa fa-check"></i><b>1.4</b> Sistema de Coordenadas</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introdução.html"><a href="introdução.html#sistemas-de-coordenadas-geográficas"><i class="fa fa-check"></i><b>1.4.1</b> Sistemas de Coordenadas Geográficas</a></li>
<li class="chapter" data-level="1.4.2" data-path="introdução.html"><a href="introdução.html#coordenadas-planas"><i class="fa fa-check"></i><b>1.4.2</b> Coordenadas planas</a></li>
<li class="chapter" data-level="1.4.3" data-path="introdução.html"><a href="introdução.html#códigos-epsg"><i class="fa fa-check"></i><b>1.4.3</b> Códigos EPSG</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introdução.html"><a href="introdução.html#open-geospatial-consortium-ogc"><i class="fa fa-check"></i><b>1.5</b> Open Geospatial Consortium (OGC)</a></li>
<li class="chapter" data-level="1.6" data-path="introdução.html"><a href="introdução.html#relacionamentos-espaciais"><i class="fa fa-check"></i><b>1.6</b> Relacionamentos espaciais</a><ul>
<li class="chapter" data-level="1.6.1" data-path="introdução.html"><a href="introdução.html#matriz-de-9-interseções-estendida-dimensionalmente"><i class="fa fa-check"></i><b>1.6.1</b> Matriz de 9-Interseções Estendida dimensionalmente</a></li>
<li class="chapter" data-level="1.6.2" data-path="introdução.html"><a href="introdução.html#relacionamentos-espaciais-nomeados"><i class="fa fa-check"></i><b>1.6.2</b> Relacionamentos espaciais nomeados</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>2</b> R 💎</a><ul>
<li class="chapter" data-level="2.1" data-path="r.html"><a href="r.html#tibble"><i class="fa fa-check"></i><b>2.1</b> Tibble</a><ul>
<li class="chapter" data-level="2.1.1" data-path="r.html"><a href="r.html#tidyverse"><i class="fa fa-check"></i><b>2.1.1</b> Tidyverse</a></li>
<li class="chapter" data-level="2.1.2" data-path="r.html"><a href="r.html#manipulação-de-dados"><i class="fa fa-check"></i><b>2.1.2</b> Manipulação de dados</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r.html"><a href="r.html#sf"><i class="fa fa-check"></i><b>2.2</b> SF</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r.html"><a href="r.html#tipos-geométricos"><i class="fa fa-check"></i><b>2.2.1</b> Tipos Geométricos</a></li>
<li class="chapter" data-level="2.2.2" data-path="r.html"><a href="r.html#leitura-e-escrita-de-dados-vetoriais"><i class="fa fa-check"></i><b>2.2.2</b> Leitura e escrita de dados vetoriais</a></li>
<li class="chapter" data-level="2.2.3" data-path="r.html"><a href="r.html#relacionamentos-espaciais-1"><i class="fa fa-check"></i><b>2.2.3</b> Relacionamentos Espaciais</a></li>
<li class="chapter" data-level="2.2.4" data-path="r.html"><a href="r.html#operadores-métricos"><i class="fa fa-check"></i><b>2.2.4</b> Operadores Métricos</a></li>
<li class="chapter" data-level="2.2.5" data-path="r.html"><a href="r.html#sistemas-de-referências"><i class="fa fa-check"></i><b>2.2.5</b> Sistemas de referências</a></li>
<li class="chapter" data-level="2.2.6" data-path="r.html"><a href="r.html#materiais-recomendados"><i class="fa fa-check"></i><b>2.2.6</b> Materiais recomendados</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>3</b> Python ✨</a><ul>
<li class="chapter" data-level="3.1" data-path="python.html"><a href="python.html#pandas"><i class="fa fa-check"></i><b>3.1</b> Pandas 🐼</a><ul>
<li class="chapter" data-level="3.1.1" data-path="python.html"><a href="python.html#manipulação-de-dados-1"><i class="fa fa-check"></i><b>3.1.1</b> Manipulação de dados</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="python.html"><a href="python.html#geopandas"><i class="fa fa-check"></i><b>3.2</b> GeoPandas 🌍🐼</a><ul>
<li class="chapter" data-level="3.2.1" data-path="python.html"><a href="python.html#geoseries-e-geodataframes"><i class="fa fa-check"></i><b>3.2.1</b> GeoSeries e GeoDataFrames</a></li>
<li class="chapter" data-level="3.2.2" data-path="python.html"><a href="python.html#leitura-e-escrita-de-dados-1"><i class="fa fa-check"></i><b>3.2.2</b> Leitura e escrita de dados</a></li>
<li class="chapter" data-level="3.2.3" data-path="python.html"><a href="python.html#manipulação-geométrica"><i class="fa fa-check"></i><b>3.2.3</b> Manipulação geométrica</a></li>
<li class="chapter" data-level="3.2.4" data-path="python.html"><a href="python.html#seleção-e-filtro-de-dados"><i class="fa fa-check"></i><b>3.2.4</b> Seleção e filtro de dados</a></li>
<li class="chapter" data-level="3.2.5" data-path="python.html"><a href="python.html#manipulação-de-projeções"><i class="fa fa-check"></i><b>3.2.5</b> Manipulação de projeções</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introdução-ao-postgis.html"><a href="introdução-ao-postgis.html"><i class="fa fa-check"></i><b>4</b> Introdução ao postgis 🐘</a><ul>
<li class="chapter" data-level="4.1" data-path="introdução-ao-postgis.html"><a href="introdução-ao-postgis.html#instalação"><i class="fa fa-check"></i><b>4.1</b> Instalação</a></li>
<li class="chapter" data-level="4.2" data-path="introdução-ao-postgis.html"><a href="introdução-ao-postgis.html#um-pouco-de-sql"><i class="fa fa-check"></i><b>4.2</b> Um pouco de SQL</a><ul>
<li class="chapter" data-level="4.2.1" data-path="introdução-ao-postgis.html"><a href="introdução-ao-postgis.html#acessando-a-interface-postgresql"><i class="fa fa-check"></i><b>4.2.1</b> Acessando a interface PostgreSQL</a></li>
<li class="chapter" data-level="4.2.2" data-path="introdução-ao-postgis.html"><a href="introdução-ao-postgis.html#criando-uma-nova-base-de-dados"><i class="fa fa-check"></i><b>4.2.2</b> Criando uma nova base de dados</a></li>
<li class="chapter" data-level="4.2.3" data-path="introdução-ao-postgis.html"><a href="introdução-ao-postgis.html#well-known-text"><i class="fa fa-check"></i><b>4.2.3</b> Well-known text</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="introdução-ao-postgis.html"><a href="introdução-ao-postgis.html#funções-geométricas"><i class="fa fa-check"></i><b>4.3</b> Funções geométricas</a></li>
<li class="chapter" data-level="4.4" data-path="introdução-ao-postgis.html"><a href="introdução-ao-postgis.html#relacionamentos-espaciais-2"><i class="fa fa-check"></i><b>4.4</b> Relacionamentos espaciais</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="para-saber-mais.html"><a href="para-saber-mais.html"><i class="fa fa-check"></i><b>5</b> Para saber mais 🔬</a><ul>
<li class="chapter" data-level="5.1" data-path="para-saber-mais.html"><a href="para-saber-mais.html#impactos-da-resolução-espacial-de-modelos-digitais-de-superfície-no-cálculo-da-perda-de-solo-através-da-eups-em-ambiente-urbano"><i class="fa fa-check"></i><b>5.1</b> <strong>IMPACTOS DA RESOLUÇÃO ESPACIAL DE MODELOS DIGITAIS DE SUPERFÍCIE NO CÁLCULO DA PERDA DE SOLO ATRAVÉS DA EUPS EM AMBIENTE URBANO</strong></a></li>
<li class="chapter" data-level="5.2" data-path="para-saber-mais.html"><a href="para-saber-mais.html#criação-e-avaliação-de-mapas-de-suscetibilidade-a-inundação-para-o-município-de-iguape-estado-de-são-paulo"><i class="fa fa-check"></i><b>5.2</b> <strong>CRIAÇÃO E AVALIAÇÃO DE MAPAS DE SUSCETIBILIDADE A INUNDAÇÃO PARA O MUNICÍPIO DE IGUAPE, ESTADO DE SÃO PAULO</strong></a></li>
<li class="chapter" data-level="5.3" data-path="para-saber-mais.html"><a href="para-saber-mais.html#conectividade-demográfica-e-aclimatação-de-peixes-recifais-do-gênero-sparisoma-em-cenário-de-mudanças-climáticas"><i class="fa fa-check"></i><b>5.3</b> <strong>CONECTIVIDADE DEMOGRÁFICA E ACLIMATAÇÃO DE PEIXES RECIFAIS DO GÊNERO SPARISOMA EM CENÁRIO DE MUDANÇAS CLIMÁTICAS</strong></a></li>
<li class="chapter" data-level="5.4" data-path="para-saber-mais.html"><a href="para-saber-mais.html#parametrização-de-algoritmos-empíricos-e-algoritmo-quasi-analítico-qaa-para-estimativa-de-clorofila-a-em-lagos-da-várzea-do-rio-amazonas"><i class="fa fa-check"></i><b>5.4</b> <strong>PARAMETRIZAÇÃO DE ALGORITMOS EMPÍRICOS E ALGORITMO QUASI-ANALÍTICO QAA PARA ESTIMATIVA DE CLOROFILA-A EM LAGOS DA VÁRZEA DO RIO AMAZONAS</strong></a></li>
<li class="chapter" data-level="5.5" data-path="para-saber-mais.html"><a href="para-saber-mais.html#quantificação-remota-da-concentração-de-sólidos-totais-e-inorgânicos-em-suspensão-em-lagos-da-planície-de-inundação-do-baixo-amazonas---uma-abordagem-multi-sensor"><i class="fa fa-check"></i><b>5.5</b> <strong>QUANTIFICAÇÃO REMOTA DA CONCENTRAÇÃO DE SÓLIDOS TOTAIS E INORGÂNICOS EM SUSPENSÃO EM LAGOS DA PLANÍCIE DE INUNDAÇÃO DO BAIXO AMAZONAS - UMA ABORDAGEM MULTI-SENSOR</strong></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introdução-ao-postgis" class="section level1">
<h1><span class="header-section-number">4</span> Introdução ao postgis 🐘</h1>
<p>Uma das principais características que diferenciam os bancos de dados geográficos dos demais bancos de dados convencionais, é a presença de uma coluna com a finalidade de armazenar uma propriedade geográfica do registro. Além disso , os bancos de dados geográficos também devem oferecer de forma otimizada suporte à operações espaciais. Diferente de um passado não muito distante, atualmente existem muitas alternativas de bancos de dados geográficos, como: <a href="https://docs.microsoft.com/pt-br/sql/relational-databases/spatial/spatial-data-sql-server?view=sql-server-ver15">SQL Server Spatial</a>, <a href="https://web.archive.org/web/20060316161213/http://www.esri.com/software/arcgis/arcsde/">ESRI ArcSDE</a>, <a href="https://www.oracle.com/database/technologies/spatialandgraph.html">Oracle Spatial</a>, <a href="https://www.geomesa.org/">GeoMesa</a>, <a href="https://postgis.net/">PostGIS</a>, etc. Cada uma destas opções tem o objetivo em comum trabalhar com dados geográficos e todas estão sendo muito utlizadas em diversos segmentos nos dias de hoje, sendo o PostGIS a mais popular de todas.</p>
<p>O PostGIS é uma extensão geográfica <em>open source</em> para o SGDB (Sistema Gerenciador de Banco de Dados) <a href="https://www.postgresql.org/">PostgreSQL</a>, lançada em 2001 inicialmente por uma empresa canadense chamada Refractions Research. O PostGIS segue a padronização estabelecida pelo OGC (<em>Open GIS Consortium</em>), que provê suporte para todos os objetos e funções da especificação <a href="https://www.opengeospatial.org/standards/sfa">SFS</a> (<em>Simple Features for</em> <em>SQL</em>). De forma concisa, a especificação SFS foi criada pelo OGC (consórcio formado por empresas, universidades, etc) e trata das questões de representação da componente espacial e vetorial dos dados geográficos, garantindo assim, a interoperabilidade entre os sistemas os utilizam.</p>
<p>Este capítulo tem como objetivo introduzir ao leitor à extensão espacial PostGIS . Ao final, o leitor estará apto a configurar corretamente o ambiente para a utilização da ferramenta, carregar arquivos vetoriais e realizar operações espaciais.</p>
<div id="instalação" class="section level2">
<h2><span class="header-section-number">4.1</span> Instalação</h2>
<p>Como o PostGIS é uma extensão do PostgreSQL, primeiramente deverá ser feita a instalação do SGBD.</p>
<blockquote>
<p><strong>Importante</strong>: Não esqueça o nome de usuário e senha que você definir durante a instalação, pois essas informações serão de suma importância, anote se necessário.</p>
</blockquote>
<p>A versão do PostgreSQL utilizada aqui é será a 11.5. A instalação do PostgreSQL e PostGIS no sistema operacional windows, pode ser feita através do instalador disponível <a href="https://www.enterprisedb.com/downloads/postgres-postgresql-downloads">nesse link</a>, para isso fique atento durante a instalação e na segunda tela do assistente, no item <code>Spatial Extensions</code> marque a opção PostGIS.</p>
<p>A instalação do PostgreSQL e PostGIS no sistema Operacional MacOS pode ser feita através do gerenciador de pacotes <code>brew</code>, utilizado os seguintes comandos:</p>
<pre class="console"><code>brew install postgres</code></pre>
<pre class="console"><code>brew install postgis</code></pre>
<p>Para a instalação nos sistemas operacionais linux, utilize os seguintes comandos :</p>
<pre class="console"><code>sudo apt install postgresql postgresql-contrib</code></pre>
<pre class="console"><code>sudo apt-get install postgis</code></pre>
<p>Para verificar se a instalação do PostgreSQL foi realizada corretamente, abra o terminal e digite o seguinte comando:</p>
<pre class="console"><code>psql --version</code></pre>
<p>Se tudo ocorreu bem, deverá aparecer uma saída com a versão do PostgreSQL, algo parecido com <code>psql (PostgreSQL) 11.5</code>.</p>
<p>Para verificar a instalação do PostGIS, abra o terminal e execute o seguinte comando para abrir o interpretador do PostgreSQL:</p>
<pre class="console"><code>sudo -u &lt;user&gt; psql</code></pre>
<blockquote>
<p><strong>Obs</strong>: Substitua o trecho <code>&lt;user&gt;</code> para o usuário do PostgreSQL definido na instalação.</p>
</blockquote>
<p>Com o terminal do PostgreSQL aberto, execute o seguinte comando para verificar a versão do PostGIS:</p>
<pre class="console"><code>SELECT PostGIS_version();</code></pre>
<p>Se tudo estiver certo, deverá aparecer como saída a versão do PostGIS. Para sair do interpretador psql, basta executar o comando <code>\q</code>. E com isso finalizamos as configuração iniciais necessárias iniciar os trabalhos com o PostGIS. Para mais informações, consulte a página oficial do PostGIS em: <a href="https://postgis.net/install/">https://postgis.net/install</a>.</p>
<p>Na próxima seção iremos criar um banco de dados novo e habilitar nele a extensão espacial PostGIS, para que possam ser executadas as nossas primeiras consultas espaciais.</p>
</div>
<div id="um-pouco-de-sql" class="section level2">
<h2><span class="header-section-number">4.2</span> Um pouco de SQL</h2>
<p>SQL (<em>Structured Query Language</em>) é linguagem padrão de consultas declarativas dos bancos de dados relacionais. Ela foi concebida na década de 1970, como resultado de um estudo feito por Edgar Frank Codd, que na época era funcionário da IBM, e propôs o modelo de banco de dados relacional <span class="citation">(Codd 1970)</span> que em sua essência é utilizado até os dias de hoje. Como dito anteriormente, o PostGIS é uma extensão espacial que funciona sobre o SGBD PosgreSQL, que utiliza o modelo de banco de dados relacional. Sendo assim, antes de iniciarmos de fato as consultas espaciais como o PostGIS, iremos executar alguns comandos SQL básicos para preparação do ambiente.</p>
<div id="acessando-a-interface-postgresql" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Acessando a interface PostgreSQL</h3>
<p>O <a href="https://www.postgresql.org/docs/11/app-psql.html"><code>psql</code></a> é uma interface padrão que funciona por linha de comando, e permite interagir rapidamente com o PostgreSQL. Como o foco deste material é a apenas apresentar alguns recursos do PostGIS, iremos executar as consultas SQL usando o psql, o que não é muito recomendado se trabalhar com esquemas mais complexos de bancos de dados, para isso, podem ser utilizadas outras interfaces mais agradáveis e eficientes como o <a href="https://www.pgadmin.org/">pgAdmin</a>.</p>
<p>Para acessar o psql execute o comando abaixo, substituindo o trecho <code>&lt;user&gt;</code>, pelo nome de usuário postgres que foi definido durante a instalação:</p>
<pre class="console"><code>sudo -u &lt;user&gt; psql</code></pre>
<p>Ao ser solicitado a senha, digite a senha de administrador do seu sistema operacional. O psql possui algumas utilitário para o gerenciamento do PostgreSQL, use o comando <code>\l</code> para listar todos os bancos de dados disponíveis, em sua máquina. Algo parecido com o que mostrado na Figura <a href="introdução-ao-postgis.html#fig:list-database">4.1</a> deverá aparecer.</p>
<div class="figure"><span id="fig:list-database"></span>
<img src="assets/images/list-databases.png" alt="Listando todos os banco de dados através do psql."  />
<p class="caption">
Figure 4.1: Listando todos os banco de dados através do psql.
</p>
</div>
<p>Normalmente, a instalação padrão do PostgreSQL cria algumas bases de dados. A seguir, iremos utilizar comandos SQL para criar um novo banco de dados e também adicionar a extensão espacial do PostGIS.</p>
</div>
<div id="criando-uma-nova-base-de-dados" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Criando uma nova base de dados</h3>
<p>A linguagem SQL é organizada em alguns subconjuntos, cada um deles com comando específicos para determinadas tarefas. A Figura <a href="introdução-ao-postgis.html#fig:schema-sql">4.2</a> mostra a os subconjuntos que compõem a linguagem SQL.</p>
<div class="figure"><span id="fig:schema-sql"></span>
<img src="assets/images/schema-sql.png" alt="Listando todos os banco de dados através do psql."  />
<p class="caption">
Figure 4.2: Listando todos os banco de dados através do psql.
</p>
</div>
<ul>
<li><p><strong>DDL - <em>Data Definition Laguage</em> (Linguagem de Definição de Dados)</strong>: É o subconjunto de instruções da linguagem SQL responsável por manipular diretamente o esquema do banco de dados e estrutura das tabelas.</p></li>
<li><p><strong>DML - <em>Data Manipulation Language</em> (Linguagem de Manipulação de Dados)</strong>: É o subconjunto de instruções da linguagem SQL responsável por interagir diretamente com os dados das tabelas.</p></li>
<li><p><strong>DCL - <em>Data Control Language</em> (Linguagem de Controle de Dados)</strong>: É o subconjunto de instruções da linguagem SQL responsável por administrar a segurança das bases de dados, adicionando ou removendo permissões.</p></li>
<li><p><strong>TCL - <em>Transaction Control Language</em> (Linguagem de Controle de Transação)</strong>: É o subconjunto de instruções da linguagem SQL responsável por gerenciar as transações das consultas SQL.</p></li>
</ul>
<p>Neste material, o escopo abordado será apenas alguns comando do subconjunto DDL e DML. Para mais informações a respeito do gerenciamento de banco de dados e a organização da linguagem SQL, recomenda-se a leitura do trabalho de <span class="citation">(Kumar, Raheja, and Sachdeva 2012)</span>, o qual aborda com mais aprofundamento estes tópicos.</p>
<p>Agora iremos criar um banco de dados para trabalharmos com os recursos espaciais do PostGIS, para isso execute o comando a seguir:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">CREATE</span> <span class="kw">DATABASE</span> dbgeo;</code></pre></div>
<p>O comando acima cria um novo banco de dados chamado <code>dbgeo</code>. Caso queira o criar um banco de dados com o nome diferente, utilize o mesmo comando substituindo o trecho <code>dbgeo</code> pelo nome desejado. Após receber a mensagem de confirmação, será necessário mudar o interpretador psql para o novo banco de dados criado, para isso utilize o seguinte comando:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql">\l dbgeo;</code></pre></div>
<p>Note que o trecho <code>dbgeo</code> é o nome da base de dados que foi criada no passo anterior. Se tudo estiver ocorrido bem, deverá aparecer a confirmação conforme a Figura <a href="introdução-ao-postgis.html#fig:change-database">4.3</a>.</p>
<div class="figure"><span id="fig:change-database"></span>
<img src="assets/images/change-database.png" alt="Criando e alterando base dados."  />
<p class="caption">
Figure 4.3: Criando e alterando base dados.
</p>
</div>
<p>Por fim, para habilitarmos a nova base de dados para suportar operações com dados espaciais, iremos adicionar a extensão PostGIS. Para isso, execute o seguinte comando:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">CREATE</span> EXTENSION postgis;</code></pre></div>
<p>Após adicionarmos a extensão PostGIS em nosso banco de dados, vamos criar a nossa primeira tabela com atributos geométricos. Para isso, iremos criar como exemplo uma tabela simples onde será armazenado o modelo de rede de detecção de raios, e sua posição geográfica (latitude/longitude), com isso praticaremos os conceitos da geometria do tipo ponto. Sendo assim, execute o seguinte comando em seu terminal:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">CREATE</span> <span class="kw">TABLE</span> lightning_network(
    <span class="kw">id</span> serial <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,
    model <span class="dt">VARCHAR</span>(<span class="dv">15</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,
    location GEOMETRY <span class="kw">NOT</span> <span class="kw">NULL</span>
);</code></pre></div>
<p>Observe que o atributo <code>location</code> da tabela, possui o tipo definido como <code>GEOMETRY</code>, esse é um dos recursos que o PostGIS, provê ao banco de dados, e tem como finalidade permitir que seja armazenado nessa coluna objetos geométricos. A seguir iremos popular nossa tabela, e realizar algumas operações espaciais. Mas antes disso, será abordado brevemente a linguagem de marcação de texto que permite a criação objetos vetoriais, o Well-known text (WKT).</p>
</div>
<div id="well-known-text" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Well-known text</h3>
<p>O WKT foi originalmente proposto pela OGC, e sendo descrita pelo <em>Simple Feature</em> <em>Access</em> <span class="citation">(OGC 2011)</span>. A forma equivalente do WKT em binário <em>Well-known</em> <em>binary</em> (WKB), também está descrita no SFA, e é como a geometria é armazenado nas tabelas. A tabela a seguir mostra os os principais tipos geométricos e suas respectivas representações em WKT.</p>
<table style="width:72%;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Tipo</th>
<th align="center">Geometria</th>
<th>WKT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Ponto</td>
<td align="center"><img src="./assets/images/g1.png" /></td>
<td><code>POINT (30 10)</code></td>
</tr>
<tr class="even">
<td align="center">Segmento</td>
<td align="center"><img src="./assets/images/g2.png" /></td>
<td><code>LINESTRING (30 10, 10 30, 40 40)</code></td>
</tr>
<tr class="odd">
<td align="center">Polígono</td>
<td align="center"><img src="./assets/images/g3.png" /></td>
<td><code>POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))</code></td>
</tr>
<tr class="even">
<td align="center">Multi-Ponto</td>
<td align="center"><img src="./assets/images/g5.png" /></td>
<td><code>MULTIPOINT (10 40, 40 30, 20 20, 30 10)</code></td>
</tr>
<tr class="odd">
<td align="center">Multi-Segmento</td>
<td align="center"><img src="./assets/images/g6.png" /></td>
<td><code>MULTILINESTRING ((10 10, 20 20, 10 40), (40 40, 30 30, 40 20, 30 10))</code></td>
</tr>
<tr class="even">
<td align="center">Muli-Polígono</td>
<td align="center"><img src="./assets/images/g7.png" /></td>
<td><code>MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)), ((15 5, 40 10, 10 20, 5 10, 15 5)))</code></td>
</tr>
<tr class="odd">
<td align="center">Coleção</td>
<td align="center"><img src="./assets/images/g8.png" /></td>
<td><code>GEOMETRYCOLLECTION (POINT (40 10), LINESTRING (10 10, 20 20, 10 40), POLYGON ((40 40, 20 45, 45 30, 40 40)))</code></td>
</tr>
</tbody>
</table>
<p><span style="text-align: center; font-size: .9em; display: block;"> Principais representações geométricas em WKT. Adaptado <a href="https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry"> Wikipédia </a>. </span></p>
<p>Para mais informações a respeito do WKT e WKB, recomenda-se a leitura do manual da <em><a href="http://portal.opengeospatial.org/files/?artifact_id=25355">Simple Feature</a></em>. Agora iremos adicionar alguns registros na tabela criada anteriormente, para isso execute o segundo comando:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">INSERT</span> <span class="kw">INTO</span> lightning_network(model, location) 
<span class="kw">VALUES</span>(<span class="st">&#39;LINET&#39;</span>, <span class="st">&#39;POINT(-23.55 -46.73)&#39;</span>);

<span class="kw">INSERT</span> <span class="kw">INTO</span> lightning_network(model, location) 
<span class="kw">VALUES</span>(<span class="st">&#39;GLD360&#39;</span>, <span class="st">&#39;POINT(-3.01 -60.05)&#39;</span>);</code></pre></div>
<p>Para verificar como ficaram armazenados os registro, execute a seguinte consulta:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> model, location <span class="kw">FROM</span> lightning_network;</code></pre></div>
<p>Como dito anteriormente, a representação da geometria por padrão é armazenada como WKT no banco de dado, portanto, ao executar a consulta anterior, deverá aparecer na saído algo como:</p>
<pre class="output"><code> id | model  |                  location                  
----+--------+--------------------------------------------
  2 | LINET  | 0101000000CDCCCCCCCC8C37C03D0AD7A3705D47C0
  3 | GLD360 | 010100000014AE47E17A1408C06666666666064EC0
(2 rows)</code></pre>
<p>O aprofundamento da estrutura WKB está fora do escopo deste material, caso o leitor deseja se aprofundar mais neste tópico, bem como no WKT, recomenda-se a leitura da <a href="https://postgis.net/docs/using_postgis_dbmanagement.html#OpenGISWKBWKT">documentação do PostGIS</a>, onde é abordado com mais detalhes este assunto. Para exibir na saída a geometria de forma mais agradável, execute:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> model, ST_AsText(location) <span class="kw">as</span> location <span class="kw">FROM</span> lightning_network;</code></pre></div>
<p>Usando a função <code>ST_AsText()</code>, a geometria será exibida formatada em WKT, como mostrado abaixo:</p>
<pre class="output"><code> model  |       location       
--------+----------------------
 LINET  | POINT(-23.55 -46.73)
 GLD360 | POINT(-3.01 -60.05)
(2 rows)</code></pre>
<p>Como o estudo aprofundado de banco de dados não faz parte do escopo deste material, e o objetivo é apenas uma introdução acerca dos conceitos relacionados os PostGIS, a partir de agora, os objetos geométricos não serão armazenados no banco de dados.</p>
</div>
</div>
<div id="funções-geométricas" class="section level2">
<h2><span class="header-section-number">4.3</span> Funções geométricas</h2>
<p>O PostGIS oferece mais de 300 funções e operadores espaciais <span class="citation">(Regina and Hsu 2011)</span>. Embora possua um grande acervo, normalmente somente algumas dessas funções e operadores são utilizadas com muita frequência. A seguir serão apresentadas funções envolvendo alguns tipos geométricos.</p>
<p><strong>Obtendo centroid</strong></p>
<p>O centro de uma geometria pode ser obtido através da função <code>ST_Centroid()</code>, passando como argumento a geométrica que se deseja obter o centroid. No exemplo a seguir, serão calculados os centróides das duas geometrias mostradas na Figura <a href="introdução-ao-postgis.html#fig:func1">4.4</a>.</p>
<center>
<div class="figure"><span id="fig:func1"></span>
<img src="assets/images/func1.png" alt="Geometrias para calcular o centroid."  />
<p class="caption">
Figure 4.4: Geometrias para calcular o centroid.
</p>
</div>
</center>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> ST_AsText(ST_Centroid(<span class="st">&#39;LINESTRING(1 2,3 4)&#39;</span>)) <span class="kw">as</span> centroid;</code></pre></div>
<p>A saída deverá ser:</p>
<pre class="console"><code>-[ RECORD 1 ]--------
centroid | POINT(2 3)</code></pre>
<p>Agora o centroid de um polígono:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> ST_AsText(ST_Centroid(<span class="st">&#39;POLYGON((4 2, 8 2, 8 4, 4 4, 4 2 ))&#39;</span>)) <span class="kw">as</span> centroid;</code></pre></div>
<p>A saída deverá ser:</p>
<pre class="console"><code>-[ RECORD 1 ]--------
centroid | POINT(6 3)</code></pre>
<p><strong>Calculando área</strong></p>
<p>A área de um polígono pode ser calculada utilizando a função <code>ST_Area</code>, como mostrado no exemplo a seguir:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> ST_Area(<span class="st">&#39;POLYGON((4 2, 8 2, 8 4, 4 4, 4 2 ))&#39;</span>) <span class="kw">as</span> area;</code></pre></div>
<p>A saída deverá ser:</p>
<pre class="console"><code>-[ RECORD 1 ]
area | 8</code></pre>
<p><strong>Calculando comprimento</strong></p>
<p>O comprimento de um segmento pode ser calculada utilizando a função <code>ST_Length</code>, como mostrado no exemplo a seguir:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> ST_Length(<span class="st">&#39;LINESTRING(1 2,3 4)&#39;</span>) <span class="kw">as</span> comprimento;</code></pre></div>
<p>A saída deverá ser:</p>
<pre class="console"><code>-[ RECORD 1 ]--------------
comprimento | 2.82842712474619</code></pre>
</div>
<div id="relacionamentos-espaciais-2" class="section level2">
<h2><span class="header-section-number">4.4</span> Relacionamentos espaciais</h2>
<p>Os relacionamentos espaciais talvez seja uma das partes mais importantes no contexto de sistemas de informações geográficas. Essas operações são baseadas na matriz de 9 interseções apresentada em capítulos anteriores deste material. O PostGIS provê uma função onde é possível obter o resultado de uma matriz de 9 interseções, passando como argumento da função <code>ST_Relate</code> duas geometrias. Como exemplo considere as geometrias que foram utilizadas na seção anterior (segmento e polígono), ao aplicar o ST_Relate, será retornado a matriz de 9 interseções como ilustrado na Figura <a href="introdução-ao-postgis.html#fig:matrix">4.5</a> e no código a seguir:</p>
<pre class="console"><code>SELECT ST_Relate(&#39;LINESTRING(1 2,3 4)&#39;, &#39;POLYGON((4 2, 8 2, 8 4, 4 4, 4 2 ))&#39;);</code></pre>
<p>Saída:</p>
<pre class="console"><code>-[ RECORD 1 ]--------
st_relate | FF1FF0212</code></pre>
<center>
<div class="figure"><span id="fig:matrix"></span>
<img src="assets/images/matrix.png" alt="ST_Relate e matriz de 9 intersecções."  />
<p class="caption">
Figure 4.5: ST_Relate e matriz de 9 intersecções.
</p>
</div>
</center>
<p>A seguir será aplicado a função <code>ST_Distance()</code> para calcular a distância entre as duas geometrias utilizadas no código anterior:</p>
<pre class="console"><code>SELECT ST_Distance(&#39;LINESTRING(1 2,3 4)&#39;, &#39;POLYGON((4 2, 8 2, 8 4, 4 4, 4 2 ))&#39;);</code></pre>
<p>Saída:</p>
<pre class="console"><code>-[ RECORD 1 ]--
st_distance | 1</code></pre>
<p>Todas os demais relacionamentos espaciais seguem o mesmo padrão das últimas consultas, ou seja, <code>ST_Função(geomtria1, geometria2)</code>. Este capítulo teve como objetivo somente introduzir o leitor ao PostGIS, tudo não passa de uma minúscula <em>ponta do iceberg</em>. A literatura é repleta de conceitos bem consolidados, desde materiais bem didáticos até mais técnicos, vale a pena da uma conferida. Uma última recomendação fica sendo o livro <em>PostGIS in Action</em> <span class="citation">(Regina and Hsu 2011)</span>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="python.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="para-saber-mais.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
