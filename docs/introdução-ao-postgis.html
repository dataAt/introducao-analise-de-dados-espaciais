<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="python.html"/>
<link rel="next" href="para-saber-mais.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html"><i class="fa fa-check"></i><b>1</b> Introdu√ß√£o üó∫</a><ul>
<li class="chapter" data-level="1.1" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#representa√ß√µes-de-dados-espaciais"><i class="fa fa-check"></i><b>1.1</b> Representa√ß√µes de dados espaciais</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#vetoriais"><i class="fa fa-check"></i><b>1.1.1</b> Vetoriais</a></li>
<li class="chapter" data-level="1.1.2" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#matriciais"><i class="fa fa-check"></i><b>1.1.2</b> Matriciais</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#sistema-de-refer√™ncia-espacial"><i class="fa fa-check"></i><b>1.2</b> Sistema de refer√™ncia espacial</a></li>
<li class="chapter" data-level="1.3" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#proje√ß√µes-cartogr√°ficas"><i class="fa fa-check"></i><b>1.3</b> Proje√ß√µes cartogr√°ficas</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#tipos-de-proje√ß√£o"><i class="fa fa-check"></i><b>1.3.1</b> Tipos de proje√ß√£o</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#sistema-de-coordenadas"><i class="fa fa-check"></i><b>1.4</b> Sistema de Coordenadas</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#sistemas-de-coordenadas-geogr√°ficas"><i class="fa fa-check"></i><b>1.4.1</b> Sistemas de Coordenadas Geogr√°ficas</a></li>
<li class="chapter" data-level="1.4.2" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#coordenadas-planas"><i class="fa fa-check"></i><b>1.4.2</b> Coordenadas planas</a></li>
<li class="chapter" data-level="1.4.3" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#c√≥digos-epsg"><i class="fa fa-check"></i><b>1.4.3</b> C√≥digos EPSG</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#open-geospatial-consortium-ogc"><i class="fa fa-check"></i><b>1.5</b> Open Geospatial Consortium (OGC)</a></li>
<li class="chapter" data-level="1.6" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#relacionamentos-espaciais"><i class="fa fa-check"></i><b>1.6</b> Relacionamentos espaciais</a><ul>
<li class="chapter" data-level="1.6.1" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#matriz-de-9-interse√ß√µes-estendida-dimensionalmente"><i class="fa fa-check"></i><b>1.6.1</b> Matriz de 9-Interse√ß√µes Estendida dimensionalmente</a></li>
<li class="chapter" data-level="1.6.2" data-path="introdu√ß√£o.html"><a href="introdu√ß√£o.html#relacionamentos-espaciais-nomeados"><i class="fa fa-check"></i><b>1.6.2</b> Relacionamentos espaciais nomeados</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>2</b> R üíé</a><ul>
<li class="chapter" data-level="2.1" data-path="r.html"><a href="r.html#tibble"><i class="fa fa-check"></i><b>2.1</b> Tibble</a><ul>
<li class="chapter" data-level="2.1.1" data-path="r.html"><a href="r.html#tidyverse"><i class="fa fa-check"></i><b>2.1.1</b> Tidyverse</a></li>
<li class="chapter" data-level="2.1.2" data-path="r.html"><a href="r.html#manipula√ß√£o-de-dados"><i class="fa fa-check"></i><b>2.1.2</b> Manipula√ß√£o de dados</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r.html"><a href="r.html#sf"><i class="fa fa-check"></i><b>2.2</b> SF</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r.html"><a href="r.html#tipos-geom√©tricos"><i class="fa fa-check"></i><b>2.2.1</b> Tipos Geom√©tricos</a></li>
<li class="chapter" data-level="2.2.2" data-path="r.html"><a href="r.html#leitura-e-escrita-de-dados-vetoriais"><i class="fa fa-check"></i><b>2.2.2</b> Leitura e escrita de dados vetoriais</a></li>
<li class="chapter" data-level="2.2.3" data-path="r.html"><a href="r.html#relacionamentos-espaciais-1"><i class="fa fa-check"></i><b>2.2.3</b> Relacionamentos Espaciais</a></li>
<li class="chapter" data-level="2.2.4" data-path="r.html"><a href="r.html#operadores-m√©tricos"><i class="fa fa-check"></i><b>2.2.4</b> Operadores M√©tricos</a></li>
<li class="chapter" data-level="2.2.5" data-path="r.html"><a href="r.html#sistemas-de-refer√™ncias"><i class="fa fa-check"></i><b>2.2.5</b> Sistemas de refer√™ncias</a></li>
<li class="chapter" data-level="2.2.6" data-path="r.html"><a href="r.html#materiais-recomendados"><i class="fa fa-check"></i><b>2.2.6</b> Materiais recomendados</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>3</b> Python ‚ú®</a><ul>
<li class="chapter" data-level="3.1" data-path="python.html"><a href="python.html#pandas"><i class="fa fa-check"></i><b>3.1</b> Pandas üêº</a><ul>
<li class="chapter" data-level="3.1.1" data-path="python.html"><a href="python.html#manipula√ß√£o-de-dados-1"><i class="fa fa-check"></i><b>3.1.1</b> Manipula√ß√£o de dados</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="python.html"><a href="python.html#geopandas"><i class="fa fa-check"></i><b>3.2</b> GeoPandas üåçüêº</a><ul>
<li class="chapter" data-level="3.2.1" data-path="python.html"><a href="python.html#geoseries-e-geodataframes"><i class="fa fa-check"></i><b>3.2.1</b> GeoSeries e GeoDataFrames</a></li>
<li class="chapter" data-level="3.2.2" data-path="python.html"><a href="python.html#leitura-e-escrita-de-dados-1"><i class="fa fa-check"></i><b>3.2.2</b> Leitura e escrita de dados</a></li>
<li class="chapter" data-level="3.2.3" data-path="python.html"><a href="python.html#manipula√ß√£o-geom√©trica"><i class="fa fa-check"></i><b>3.2.3</b> Manipula√ß√£o geom√©trica</a></li>
<li class="chapter" data-level="3.2.4" data-path="python.html"><a href="python.html#sele√ß√£o-e-filtro-de-dados"><i class="fa fa-check"></i><b>3.2.4</b> Sele√ß√£o e filtro de dados</a></li>
<li class="chapter" data-level="3.2.5" data-path="python.html"><a href="python.html#manipula√ß√£o-de-proje√ß√µes"><i class="fa fa-check"></i><b>3.2.5</b> Manipula√ß√£o de proje√ß√µes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introdu√ß√£o-ao-postgis.html"><a href="introdu√ß√£o-ao-postgis.html"><i class="fa fa-check"></i><b>4</b> Introdu√ß√£o ao postgis üêò</a><ul>
<li class="chapter" data-level="4.1" data-path="introdu√ß√£o-ao-postgis.html"><a href="introdu√ß√£o-ao-postgis.html#instala√ß√£o"><i class="fa fa-check"></i><b>4.1</b> Instala√ß√£o</a></li>
<li class="chapter" data-level="4.2" data-path="introdu√ß√£o-ao-postgis.html"><a href="introdu√ß√£o-ao-postgis.html#um-pouco-de-sql"><i class="fa fa-check"></i><b>4.2</b> Um pouco de SQL</a><ul>
<li class="chapter" data-level="4.2.1" data-path="introdu√ß√£o-ao-postgis.html"><a href="introdu√ß√£o-ao-postgis.html#acessando-a-interface-postgresql"><i class="fa fa-check"></i><b>4.2.1</b> Acessando a interface PostgreSQL</a></li>
<li class="chapter" data-level="4.2.2" data-path="introdu√ß√£o-ao-postgis.html"><a href="introdu√ß√£o-ao-postgis.html#criando-uma-nova-base-de-dados"><i class="fa fa-check"></i><b>4.2.2</b> Criando uma nova base de dados</a></li>
<li class="chapter" data-level="4.2.3" data-path="introdu√ß√£o-ao-postgis.html"><a href="introdu√ß√£o-ao-postgis.html#well-known-text"><i class="fa fa-check"></i><b>4.2.3</b> Well-known text</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="introdu√ß√£o-ao-postgis.html"><a href="introdu√ß√£o-ao-postgis.html#fun√ß√µes-geom√©tricas"><i class="fa fa-check"></i><b>4.3</b> Fun√ß√µes geom√©tricas</a></li>
<li class="chapter" data-level="4.4" data-path="introdu√ß√£o-ao-postgis.html"><a href="introdu√ß√£o-ao-postgis.html#relacionamentos-espaciais-2"><i class="fa fa-check"></i><b>4.4</b> Relacionamentos espaciais</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="para-saber-mais.html"><a href="para-saber-mais.html"><i class="fa fa-check"></i><b>5</b> Para saber mais üî¨</a><ul>
<li class="chapter" data-level="5.1" data-path="para-saber-mais.html"><a href="para-saber-mais.html#impactos-da-resolu√ß√£o-espacial-de-modelos-digitais-de-superf√≠cie-no-c√°lculo-da-perda-de-solo-atrav√©s-da-eups-em-ambiente-urbano"><i class="fa fa-check"></i><b>5.1</b> <strong>IMPACTOS DA RESOLU√á√ÉO ESPACIAL DE MODELOS DIGITAIS DE SUPERF√çCIE NO C√ÅLCULO DA PERDA DE SOLO ATRAV√âS DA EUPS EM AMBIENTE URBANO</strong></a></li>
<li class="chapter" data-level="5.2" data-path="para-saber-mais.html"><a href="para-saber-mais.html#cria√ß√£o-e-avalia√ß√£o-de-mapas-de-suscetibilidade-a-inunda√ß√£o-para-o-munic√≠pio-de-iguape-estado-de-s√£o-paulo"><i class="fa fa-check"></i><b>5.2</b> <strong>CRIA√á√ÉO E AVALIA√á√ÉO DE MAPAS DE SUSCETIBILIDADE A INUNDA√á√ÉO PARA O MUNIC√çPIO DE IGUAPE, ESTADO DE S√ÉO PAULO</strong></a></li>
<li class="chapter" data-level="5.3" data-path="para-saber-mais.html"><a href="para-saber-mais.html#conectividade-demogr√°fica-e-aclimata√ß√£o-de-peixes-recifais-do-g√™nero-sparisoma-em-cen√°rio-de-mudan√ßas-clim√°ticas"><i class="fa fa-check"></i><b>5.3</b> <strong>CONECTIVIDADE DEMOGR√ÅFICA E ACLIMATA√á√ÉO DE PEIXES RECIFAIS DO G√äNERO SPARISOMA EM CEN√ÅRIO DE MUDAN√áAS CLIM√ÅTICAS</strong></a></li>
<li class="chapter" data-level="5.4" data-path="para-saber-mais.html"><a href="para-saber-mais.html#parametriza√ß√£o-de-algoritmos-emp√≠ricos-e-algoritmo-quasi-anal√≠tico-qaa-para-estimativa-de-clorofila-a-em-lagos-da-v√°rzea-do-rio-amazonas"><i class="fa fa-check"></i><b>5.4</b> <strong>PARAMETRIZA√á√ÉO DE ALGORITMOS EMP√çRICOS E ALGORITMO QUASI-ANAL√çTICO QAA PARA ESTIMATIVA DE CLOROFILA-A EM LAGOS DA V√ÅRZEA DO RIO AMAZONAS</strong></a></li>
<li class="chapter" data-level="5.5" data-path="para-saber-mais.html"><a href="para-saber-mais.html#quantifica√ß√£o-remota-da-concentra√ß√£o-de-s√≥lidos-totais-e-inorg√¢nicos-em-suspens√£o-em-lagos-da-plan√≠cie-de-inunda√ß√£o-do-baixo-amazonas---uma-abordagem-multi-sensor"><i class="fa fa-check"></i><b>5.5</b> <strong>QUANTIFICA√á√ÉO REMOTA DA CONCENTRA√á√ÉO DE S√ìLIDOS TOTAIS E INORG√ÇNICOS EM SUSPENS√ÉO EM LAGOS DA PLAN√çCIE DE INUNDA√á√ÉO DO BAIXO AMAZONAS - UMA ABORDAGEM MULTI-SENSOR</strong></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introdu√ß√£o-ao-postgis" class="section level1">
<h1><span class="header-section-number">4</span> Introdu√ß√£o ao postgis üêò</h1>
<p>Uma das principais caracter√≠sticas que diferenciam os bancos de dados geogr√°ficos dos demais bancos de dados convencionais, √© a presen√ßa de uma coluna com a finalidade de armazenar uma propriedade geogr√°fica do registro. Al√©m disso , os bancos de dados geogr√°ficos tamb√©m devem oferecer de forma otimizada suporte √† opera√ß√µes espaciais. Diferente de um passado n√£o muito distante, atualmente existem muitas alternativas de bancos de dados geogr√°ficos, como: <a href="https://docs.microsoft.com/pt-br/sql/relational-databases/spatial/spatial-data-sql-server?view=sql-server-ver15">SQL Server Spatial</a>, <a href="https://web.archive.org/web/20060316161213/http://www.esri.com/software/arcgis/arcsde/">ESRI ArcSDE</a>, <a href="https://www.oracle.com/database/technologies/spatialandgraph.html">Oracle Spatial</a>, <a href="https://www.geomesa.org/">GeoMesa</a>, <a href="https://postgis.net/">PostGIS</a>, etc. Cada uma destas op√ß√µes tem o objetivo em comum trabalhar com dados geogr√°ficos e todas est√£o sendo muito utlizadas em diversos segmentos nos dias de hoje, sendo o PostGIS a mais popular de todas.</p>
<p>O PostGIS √© uma extens√£o geogr√°fica <em>open source</em> para o SGDB (Sistema Gerenciador de Banco de Dados) <a href="https://www.postgresql.org/">PostgreSQL</a>, lan√ßada em 2001 inicialmente por uma empresa canadense chamada Refractions Research. O PostGIS segue a padroniza√ß√£o estabelecida pelo OGC (<em>Open GIS Consortium</em>), que prov√™ suporte para todos os objetos e fun√ß√µes da especifica√ß√£o <a href="https://www.opengeospatial.org/standards/sfa">SFS</a> (<em>Simple Features for</em> <em>SQL</em>). De forma concisa, a especifica√ß√£o SFS foi criada pelo OGC (cons√≥rcio formado por empresas, universidades, etc) e trata das quest√µes de representa√ß√£o da componente espacial e vetorial dos dados geogr√°ficos, garantindo assim, a interoperabilidade entre os sistemas os utilizam.</p>
<p>Este cap√≠tulo tem como objetivo introduzir ao leitor √† extens√£o espacial PostGIS . Ao final, o leitor estar√° apto a configurar corretamente o ambiente para a utiliza√ß√£o da ferramenta, carregar arquivos vetoriais e realizar opera√ß√µes espaciais.</p>
<div id="instala√ß√£o" class="section level2">
<h2><span class="header-section-number">4.1</span> Instala√ß√£o</h2>
<p>Como o PostGIS √© uma extens√£o do PostgreSQL, primeiramente dever√° ser feita a instala√ß√£o do SGBD.</p>
<blockquote>
<p><strong>Importante</strong>: N√£o esque√ßa o nome de usu√°rio e senha que voc√™ definir durante a instala√ß√£o, pois essas informa√ß√µes ser√£o de suma import√¢ncia, anote se necess√°rio.</p>
</blockquote>
<p>A vers√£o do PostgreSQL utilizada aqui √© ser√° a 11.5. A instala√ß√£o do PostgreSQL e PostGIS no sistema operacional windows, pode ser feita atrav√©s do instalador dispon√≠vel <a href="https://www.enterprisedb.com/downloads/postgres-postgresql-downloads">nesse link</a>, para isso fique atento durante a instala√ß√£o e na segunda tela do assistente, no item <code>Spatial Extensions</code> marque a op√ß√£o PostGIS.</p>
<p>A instala√ß√£o do PostgreSQL e PostGIS no sistema Operacional MacOS pode ser feita atrav√©s do gerenciador de pacotes <code>brew</code>, utilizado os seguintes comandos:</p>
<pre class="console"><code>brew install postgres</code></pre>
<pre class="console"><code>brew install postgis</code></pre>
<p>Para a instala√ß√£o nos sistemas operacionais linux, utilize os seguintes comandos :</p>
<pre class="console"><code>sudo apt install postgresql postgresql-contrib</code></pre>
<pre class="console"><code>sudo apt-get install postgis</code></pre>
<p>Para verificar se a instala√ß√£o do PostgreSQL foi realizada corretamente, abra o terminal e digite o seguinte comando:</p>
<pre class="console"><code>psql --version</code></pre>
<p>Se tudo ocorreu bem, dever√° aparecer uma sa√≠da com a vers√£o do PostgreSQL, algo parecido com <code>psql (PostgreSQL) 11.5</code>.</p>
<p>Para verificar a instala√ß√£o do PostGIS, abra o terminal e execute o seguinte comando para abrir o interpretador do PostgreSQL:</p>
<pre class="console"><code>sudo -u &lt;user&gt; psql</code></pre>
<blockquote>
<p><strong>Obs</strong>: Substitua o trecho <code>&lt;user&gt;</code> para o usu√°rio do PostgreSQL definido na instala√ß√£o.</p>
</blockquote>
<p>Com o terminal do PostgreSQL aberto, execute o seguinte comando para verificar a vers√£o do PostGIS:</p>
<pre class="console"><code>SELECT PostGIS_version();</code></pre>
<p>Se tudo estiver certo, dever√° aparecer como sa√≠da a vers√£o do PostGIS. Para sair do interpretador psql, basta executar o comando <code>\q</code>. E com isso finalizamos as configura√ß√£o iniciais necess√°rias iniciar os trabalhos com o PostGIS. Para mais informa√ß√µes, consulte a p√°gina oficial do PostGIS em: <a href="https://postgis.net/install/">https://postgis.net/install</a>.</p>
<p>Na pr√≥xima se√ß√£o iremos criar um banco de dados novo e habilitar nele a extens√£o espacial PostGIS, para que possam ser executadas as nossas primeiras consultas espaciais.</p>
</div>
<div id="um-pouco-de-sql" class="section level2">
<h2><span class="header-section-number">4.2</span> Um pouco de SQL</h2>
<p>SQL (<em>Structured Query Language</em>) √© linguagem padr√£o de consultas declarativas dos bancos de dados relacionais. Ela foi concebida na d√©cada de 1970, como resultado de um estudo feito por Edgar Frank Codd, que na √©poca era funcion√°rio da IBM, e prop√¥s o modelo de banco de dados relacional <span class="citation">(Codd 1970)</span> que em sua ess√™ncia √© utilizado at√© os dias de hoje. Como dito anteriormente, o PostGIS √© uma extens√£o espacial que funciona sobre o SGBD PosgreSQL, que utiliza o modelo de banco de dados relacional. Sendo assim, antes de iniciarmos de fato as consultas espaciais como o PostGIS, iremos executar alguns comandos SQL b√°sicos para prepara√ß√£o do ambiente.</p>
<div id="acessando-a-interface-postgresql" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Acessando a interface PostgreSQL</h3>
<p>O <a href="https://www.postgresql.org/docs/11/app-psql.html"><code>psql</code></a> √© uma interface padr√£o que funciona por linha de comando, e permite interagir rapidamente com o PostgreSQL. Como o foco deste material √© a apenas apresentar alguns recursos do PostGIS, iremos executar as consultas SQL usando o psql, o que n√£o √© muito recomendado se trabalhar com esquemas mais complexos de bancos de dados, para isso, podem ser utilizadas outras interfaces mais agrad√°veis e eficientes como o <a href="https://www.pgadmin.org/">pgAdmin</a>.</p>
<p>Para acessar o psql execute o comando abaixo, substituindo o trecho <code>&lt;user&gt;</code>, pelo nome de usu√°rio postgres que foi definido durante a instala√ß√£o:</p>
<pre class="console"><code>sudo -u &lt;user&gt; psql</code></pre>
<p>Ao ser solicitado a senha, digite a senha de administrador do seu sistema operacional. O psql possui algumas utilit√°rio para o gerenciamento do PostgreSQL, use o comando <code>\l</code> para listar todos os bancos de dados dispon√≠veis, em sua m√°quina. Algo parecido com o que mostrado na Figura <a href="introdu√ß√£o-ao-postgis.html#fig:list-database">4.1</a> dever√° aparecer.</p>
<div class="figure"><span id="fig:list-database"></span>
<img src="assets/images/list-databases.png" alt="Listando todos os banco de dados atrav√©s do psql."  />
<p class="caption">
Figure 4.1: Listando todos os banco de dados atrav√©s do psql.
</p>
</div>
<p>Normalmente, a instala√ß√£o padr√£o do PostgreSQL cria algumas bases de dados. A seguir, iremos utilizar comandos SQL para criar um novo banco de dados e tamb√©m adicionar a extens√£o espacial do PostGIS.</p>
</div>
<div id="criando-uma-nova-base-de-dados" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Criando uma nova base de dados</h3>
<p>A linguagem SQL √© organizada em alguns subconjuntos, cada um deles com comando espec√≠ficos para determinadas tarefas. A Figura <a href="introdu√ß√£o-ao-postgis.html#fig:schema-sql">4.2</a> mostra a os subconjuntos que comp√µem a linguagem SQL.</p>
<div class="figure"><span id="fig:schema-sql"></span>
<img src="assets/images/schema-sql.png" alt="Listando todos os banco de dados atrav√©s do psql."  />
<p class="caption">
Figure 4.2: Listando todos os banco de dados atrav√©s do psql.
</p>
</div>
<ul>
<li><p><strong>DDL - <em>Data Definition Laguage</em> (Linguagem de Defini√ß√£o de Dados)</strong>: √â o subconjunto de instru√ß√µes da linguagem SQL respons√°vel por manipular diretamente o esquema do banco de dados e estrutura das tabelas.</p></li>
<li><p><strong>DML - <em>Data Manipulation Language</em> (Linguagem de Manipula√ß√£o de Dados)</strong>: √â o subconjunto de instru√ß√µes da linguagem SQL respons√°vel por interagir diretamente com os dados das tabelas.</p></li>
<li><p><strong>DCL - <em>Data Control Language</em> (Linguagem de Controle de Dados)</strong>: √â o subconjunto de instru√ß√µes da linguagem SQL respons√°vel por administrar a seguran√ßa das bases de dados, adicionando ou removendo permiss√µes.</p></li>
<li><p><strong>TCL - <em>Transaction Control Language</em> (Linguagem de Controle de Transa√ß√£o)</strong>: √â o subconjunto de instru√ß√µes da linguagem SQL respons√°vel por gerenciar as transa√ß√µes das consultas SQL.</p></li>
</ul>
<p>Neste material, o escopo abordado ser√° apenas alguns comando do subconjunto DDL e DML. Para mais informa√ß√µes a respeito do gerenciamento de banco de dados e a organiza√ß√£o da linguagem SQL, recomenda-se a leitura do trabalho de <span class="citation">(Kumar, Raheja, and Sachdeva 2012)</span>, o qual aborda com mais aprofundamento estes t√≥picos.</p>
<p>Agora iremos criar um banco de dados para trabalharmos com os recursos espaciais do PostGIS, para isso execute o comando a seguir:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">CREATE</span> <span class="kw">DATABASE</span> dbgeo;</code></pre></div>
<p>O comando acima cria um novo banco de dados chamado <code>dbgeo</code>. Caso queira o criar um banco de dados com o nome diferente, utilize o mesmo comando substituindo o trecho <code>dbgeo</code> pelo nome desejado. Ap√≥s receber a mensagem de confirma√ß√£o, ser√° necess√°rio mudar o interpretador psql para o novo banco de dados criado, para isso utilize o seguinte comando:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql">\l dbgeo;</code></pre></div>
<p>Note que o trecho <code>dbgeo</code> √© o nome da base de dados que foi criada no passo anterior. Se tudo estiver ocorrido bem, dever√° aparecer a confirma√ß√£o conforme a Figura <a href="introdu√ß√£o-ao-postgis.html#fig:change-database">4.3</a>.</p>
<div class="figure"><span id="fig:change-database"></span>
<img src="assets/images/change-database.png" alt="Criando e alterando base dados."  />
<p class="caption">
Figure 4.3: Criando e alterando base dados.
</p>
</div>
<p>Por fim, para habilitarmos a nova base de dados para suportar opera√ß√µes com dados espaciais, iremos adicionar a extens√£o PostGIS. Para isso, execute o seguinte comando:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">CREATE</span> EXTENSION postgis;</code></pre></div>
<p>Ap√≥s adicionarmos a extens√£o PostGIS em nosso banco de dados, vamos criar a nossa primeira tabela com atributos geom√©tricos. Para isso, iremos criar como exemplo uma tabela simples onde ser√° armazenado o modelo de rede de detec√ß√£o de raios, e sua posi√ß√£o geogr√°fica (latitude/longitude), com isso praticaremos os conceitos da geometria do tipo ponto. Sendo assim, execute o seguinte comando em seu terminal:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">CREATE</span> <span class="kw">TABLE</span> lightning_network(
    <span class="kw">id</span> serial <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,
    model <span class="dt">VARCHAR</span>(<span class="dv">15</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,
    location GEOMETRY <span class="kw">NOT</span> <span class="kw">NULL</span>
);</code></pre></div>
<p>Observe que o atributo <code>location</code> da tabela, possui o tipo definido como <code>GEOMETRY</code>, esse √© um dos recursos que o PostGIS, prov√™ ao banco de dados, e tem como finalidade permitir que seja armazenado nessa coluna objetos geom√©tricos. A seguir iremos popular nossa tabela, e realizar algumas opera√ß√µes espaciais. Mas antes disso, ser√° abordado brevemente a linguagem de marca√ß√£o de texto que permite a cria√ß√£o objetos vetoriais, o Well-known text (WKT).</p>
</div>
<div id="well-known-text" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Well-known text</h3>
<p>O WKT foi originalmente proposto pela OGC, e sendo descrita pelo <em>Simple Feature</em> <em>Access</em> <span class="citation">(OGC 2011)</span>. A forma equivalente do WKT em bin√°rio <em>Well-known</em> <em>binary</em> (WKB), tamb√©m est√° descrita no SFA, e √© como a geometria √© armazenado nas tabelas. A tabela a seguir mostra os os principais tipos geom√©tricos e suas respectivas representa√ß√µes em WKT.</p>
<table style="width:72%;">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Tipo</th>
<th align="center">Geometria</th>
<th>WKT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Ponto</td>
<td align="center"><img src="./assets/images/g1.png" /></td>
<td><code>POINT (30 10)</code></td>
</tr>
<tr class="even">
<td align="center">Segmento</td>
<td align="center"><img src="./assets/images/g2.png" /></td>
<td><code>LINESTRING (30 10, 10 30, 40 40)</code></td>
</tr>
<tr class="odd">
<td align="center">Pol√≠gono</td>
<td align="center"><img src="./assets/images/g3.png" /></td>
<td><code>POLYGON ((30 10, 40 40, 20 40, 10 20, 30 10))</code></td>
</tr>
<tr class="even">
<td align="center">Multi-Ponto</td>
<td align="center"><img src="./assets/images/g5.png" /></td>
<td><code>MULTIPOINT (10 40, 40 30, 20 20, 30 10)</code></td>
</tr>
<tr class="odd">
<td align="center">Multi-Segmento</td>
<td align="center"><img src="./assets/images/g6.png" /></td>
<td><code>MULTILINESTRING ((10 10, 20 20, 10 40), (40 40, 30 30, 40 20, 30 10))</code></td>
</tr>
<tr class="even">
<td align="center">Muli-Pol√≠gono</td>
<td align="center"><img src="./assets/images/g7.png" /></td>
<td><code>MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)), ((15 5, 40 10, 10 20, 5 10, 15 5)))</code></td>
</tr>
<tr class="odd">
<td align="center">Cole√ß√£o</td>
<td align="center"><img src="./assets/images/g8.png" /></td>
<td><code>GEOMETRYCOLLECTION (POINT (40 10), LINESTRING (10 10, 20 20, 10 40), POLYGON ((40 40, 20 45, 45 30, 40 40)))</code></td>
</tr>
</tbody>
</table>
<p><span style="text-align: center; font-size: .9em; display: block;"> Principais representa√ß√µes geom√©tricas em WKT. Adaptado <a href="https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry"> Wikip√©dia </a>. </span></p>
<p>Para mais informa√ß√µes a respeito do WKT e WKB, recomenda-se a leitura do manual da <em><a href="http://portal.opengeospatial.org/files/?artifact_id=25355">Simple Feature</a></em>. Agora iremos adicionar alguns registros na tabela criada anteriormente, para isso execute o segundo comando:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">INSERT</span> <span class="kw">INTO</span> lightning_network(model, location) 
<span class="kw">VALUES</span>(<span class="st">&#39;LINET&#39;</span>, <span class="st">&#39;POINT(-23.55 -46.73)&#39;</span>);

<span class="kw">INSERT</span> <span class="kw">INTO</span> lightning_network(model, location) 
<span class="kw">VALUES</span>(<span class="st">&#39;GLD360&#39;</span>, <span class="st">&#39;POINT(-3.01 -60.05)&#39;</span>);</code></pre></div>
<p>Para verificar como ficaram armazenados os registro, execute a seguinte consulta:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> model, location <span class="kw">FROM</span> lightning_network;</code></pre></div>
<p>Como dito anteriormente, a representa√ß√£o da geometria por padr√£o √© armazenada como WKT no banco de dado, portanto, ao executar a consulta anterior, dever√° aparecer na sa√≠do algo como:</p>
<pre class="output"><code> id | model  |                  location                  
----+--------+--------------------------------------------
  2 | LINET  | 0101000000CDCCCCCCCC8C37C03D0AD7A3705D47C0
  3 | GLD360 | 010100000014AE47E17A1408C06666666666064EC0
(2 rows)</code></pre>
<p>O aprofundamento da estrutura WKB est√° fora do escopo deste material, caso o leitor deseja se aprofundar mais neste t√≥pico, bem como no WKT, recomenda-se a leitura da <a href="https://postgis.net/docs/using_postgis_dbmanagement.html#OpenGISWKBWKT">documenta√ß√£o do PostGIS</a>, onde √© abordado com mais detalhes este assunto. Para exibir na sa√≠da a geometria de forma mais agrad√°vel, execute:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> model, ST_AsText(location) <span class="kw">as</span> location <span class="kw">FROM</span> lightning_network;</code></pre></div>
<p>Usando a fun√ß√£o <code>ST_AsText()</code>, a geometria ser√° exibida formatada em WKT, como mostrado abaixo:</p>
<pre class="output"><code> model  |       location       
--------+----------------------
 LINET  | POINT(-23.55 -46.73)
 GLD360 | POINT(-3.01 -60.05)
(2 rows)</code></pre>
<p>Como o estudo aprofundado de banco de dados n√£o faz parte do escopo deste material, e o objetivo √© apenas uma introdu√ß√£o acerca dos conceitos relacionados os PostGIS, a partir de agora, os objetos geom√©tricos n√£o ser√£o armazenados no banco de dados.</p>
</div>
</div>
<div id="fun√ß√µes-geom√©tricas" class="section level2">
<h2><span class="header-section-number">4.3</span> Fun√ß√µes geom√©tricas</h2>
<p>O PostGIS oferece mais de 300 fun√ß√µes e operadores espaciais <span class="citation">(Regina and Hsu 2011)</span>. Embora possua um grande acervo, normalmente somente algumas dessas fun√ß√µes e operadores s√£o utilizadas com muita frequ√™ncia. A seguir ser√£o apresentadas fun√ß√µes envolvendo alguns tipos geom√©tricos.</p>
<p><strong>Obtendo centroid</strong></p>
<p>O centro de uma geometria pode ser obtido atrav√©s da fun√ß√£o <code>ST_Centroid()</code>, passando como argumento a geom√©trica que se deseja obter o centroid. No exemplo a seguir, ser√£o calculados os centr√≥ides das duas geometrias mostradas na Figura <a href="introdu√ß√£o-ao-postgis.html#fig:func1">4.4</a>.</p>
<center>
<div class="figure"><span id="fig:func1"></span>
<img src="assets/images/func1.png" alt="Geometrias para calcular o centroid."  />
<p class="caption">
Figure 4.4: Geometrias para calcular o centroid.
</p>
</div>
</center>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> ST_AsText(ST_Centroid(<span class="st">&#39;LINESTRING(1 2,3 4)&#39;</span>)) <span class="kw">as</span> centroid;</code></pre></div>
<p>A sa√≠da dever√° ser:</p>
<pre class="console"><code>-[ RECORD 1 ]--------
centroid | POINT(2 3)</code></pre>
<p>Agora o centroid de um pol√≠gono:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> ST_AsText(ST_Centroid(<span class="st">&#39;POLYGON((4 2, 8 2, 8 4, 4 4, 4 2 ))&#39;</span>)) <span class="kw">as</span> centroid;</code></pre></div>
<p>A sa√≠da dever√° ser:</p>
<pre class="console"><code>-[ RECORD 1 ]--------
centroid | POINT(6 3)</code></pre>
<p><strong>Calculando √°rea</strong></p>
<p>A √°rea de um pol√≠gono pode ser calculada utilizando a fun√ß√£o <code>ST_Area</code>, como mostrado no exemplo a seguir:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> ST_Area(<span class="st">&#39;POLYGON((4 2, 8 2, 8 4, 4 4, 4 2 ))&#39;</span>) <span class="kw">as</span> area;</code></pre></div>
<p>A sa√≠da dever√° ser:</p>
<pre class="console"><code>-[ RECORD 1 ]
area | 8</code></pre>
<p><strong>Calculando comprimento</strong></p>
<p>O comprimento de um segmento pode ser calculada utilizando a fun√ß√£o <code>ST_Length</code>, como mostrado no exemplo a seguir:</p>
<div class="sourceCode"><pre class="sourceCode sql"><code class="sourceCode sql"><span class="kw">SELECT</span> ST_Length(<span class="st">&#39;LINESTRING(1 2,3 4)&#39;</span>) <span class="kw">as</span> comprimento;</code></pre></div>
<p>A sa√≠da dever√° ser:</p>
<pre class="console"><code>-[ RECORD 1 ]--------------
comprimento | 2.82842712474619</code></pre>
</div>
<div id="relacionamentos-espaciais-2" class="section level2">
<h2><span class="header-section-number">4.4</span> Relacionamentos espaciais</h2>
<p>Os relacionamentos espaciais talvez seja uma das partes mais importantes no contexto de sistemas de informa√ß√µes geogr√°ficas. Essas opera√ß√µes s√£o baseadas na matriz de 9 interse√ß√µes apresentada em cap√≠tulos anteriores deste material. O PostGIS prov√™ uma fun√ß√£o onde √© poss√≠vel obter o resultado de uma matriz de 9 interse√ß√µes, passando como argumento da fun√ß√£o <code>ST_Relate</code> duas geometrias. Como exemplo considere as geometrias que foram utilizadas na se√ß√£o anterior (segmento e pol√≠gono), ao aplicar o ST_Relate, ser√° retornado a matriz de 9 interse√ß√µes como ilustrado na Figura <a href="introdu√ß√£o-ao-postgis.html#fig:matrix">4.5</a> e no c√≥digo a seguir:</p>
<pre class="console"><code>SELECT ST_Relate(&#39;LINESTRING(1 2,3 4)&#39;, &#39;POLYGON((4 2, 8 2, 8 4, 4 4, 4 2 ))&#39;);</code></pre>
<p>Sa√≠da:</p>
<pre class="console"><code>-[ RECORD 1 ]--------
st_relate | FF1FF0212</code></pre>
<center>
<div class="figure"><span id="fig:matrix"></span>
<img src="assets/images/matrix.png" alt="ST_Relate e matriz de 9 intersec√ß√µes."  />
<p class="caption">
Figure 4.5: ST_Relate e matriz de 9 intersec√ß√µes.
</p>
</div>
</center>
<p>A seguir ser√° aplicado a fun√ß√£o <code>ST_Distance()</code> para calcular a dist√¢ncia entre as duas geometrias utilizadas no c√≥digo anterior:</p>
<pre class="console"><code>SELECT ST_Distance(&#39;LINESTRING(1 2,3 4)&#39;, &#39;POLYGON((4 2, 8 2, 8 4, 4 4, 4 2 ))&#39;);</code></pre>
<p>Sa√≠da:</p>
<pre class="console"><code>-[ RECORD 1 ]--
st_distance | 1</code></pre>
<p>Todas os demais relacionamentos espaciais seguem o mesmo padr√£o das √∫ltimas consultas, ou seja, <code>ST_Fun√ß√£o(geomtria1, geometria2)</code>. Este cap√≠tulo teve como objetivo somente introduzir o leitor ao PostGIS, tudo n√£o passa de uma min√∫scula <em>ponta do iceberg</em>. A literatura √© repleta de conceitos bem consolidados, desde materiais bem did√°ticos at√© mais t√©cnicos, vale a pena da uma conferida. Uma √∫ltima recomenda√ß√£o fica sendo o livro <em>PostGIS in Action</em> <span class="citation">(Regina and Hsu 2011)</span>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="python.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="para-saber-mais.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
